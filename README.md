# @hpplay-lebo/cluster-hub

OpenClaw Hub é›†ç¾¤æ’ä»¶ â€” è®©å¤šå° OpenClaw èŠ‚ç‚¹è·¨ç½‘ç»œåä½œï¼Œå®ç°èŠå¤©ã€ä»»åŠ¡åˆ†å‘å’Œé›†ç¾¤ç®¡ç†ã€‚

## åŠŸèƒ½

- ğŸŒ **è·¨ç½‘ç»œç»„ç½‘** â€” é€šè¿‡äº‘ç«¯ Hub ä¸­è½¬ï¼Œä¸åŒç½‘ç»œä¸‹çš„ OpenClaw èŠ‚ç‚¹è‡ªåŠ¨ç»„æˆé›†ç¾¤
- ğŸ’¬ **èŠ‚ç‚¹é—´èŠå¤©** â€” ä»é£ä¹¦/æ§åˆ¶å°ä¸é›†ç¾¤ä¸­ä»»æ„èŠ‚ç‚¹å¯¹è¯ï¼ˆä¸é™çˆ¶å­å…³ç³»ï¼‰
- âš¡ **ä»»åŠ¡åˆ†å‘** â€” å‘å­èŠ‚ç‚¹ä¸‹å‘ä»»åŠ¡ï¼Œæ”¯æŒæ‰¹é‡å¹¶è¡Œ + ç­‰å¾…æ±‡æ€»
- ğŸŒ³ **æ ‘å½¢é›†ç¾¤** â€” æ”¯æŒå¤šå±‚æ ‘å½¢ç»“æ„ï¼ˆæœ€å¤§æ·±åº¦ 5 å±‚ï¼‰ï¼Œé‚€è¯·ç åŠ å…¥
- ğŸ“Š **çŠ¶æ€ç›‘æ§** â€” å®æ—¶å¿ƒè·³ã€åœ¨çº¿çŠ¶æ€ã€ä»»åŠ¡ç»Ÿè®¡
- ğŸ”Œ **è‡ªåŠ¨é‡è¿** â€” æ–­çº¿åè‡ªåŠ¨é‡è¿ï¼Œç¦»çº¿æ¶ˆæ¯é˜Ÿåˆ—
- ğŸ“„ **é£ä¹¦å·¥å…·ä¸‹å‘** â€” Hub è‡ªåŠ¨ä¸‹å‘é£ä¹¦å‡­æ®ï¼Œå­èŠ‚ç‚¹æ— éœ€é…ç½®å³å¯æ“ä½œé£ä¹¦æ–‡æ¡£/çŸ¥è¯†åº“/äº‘ç©ºé—´
- ğŸ› ï¸ **CLI + AI å·¥å…· + RPC** â€” ä¸‰ç§ä½¿ç”¨æ–¹å¼

## å®‰è£…

```bash
# å…‹éš†åˆ° OpenClaw æ’ä»¶ç›®å½•
cd ~/.openclaw/extensions
git clone https://github.com/shenyingjun5/cluster-hub.git cluster-hub

# é‡å¯ Gateway
openclaw gateway restart
```

### éªŒè¯å®‰è£…

```bash
openclaw plugins list
# åº”çœ‹åˆ° cluster-hub çŠ¶æ€ä¸º loaded
```

## é…ç½®

å®‰è£…åç¼–è¾‘ `~/.openclaw/openclaw.json`ï¼Œåœ¨ `plugins.entries` ä¸­æ·»åŠ  `cluster-hub` é…ç½®ï¼š

```jsonc
{
  "plugins": {
    "entries": {
      "cluster-hub": {
        "enabled": true,
        "config": {
          // Hub æœåŠ¡åœ°å€
          "hubUrl": "https://hub.openclaw.ai",
          // èŠ‚ç‚¹æ˜¾ç¤ºåç§°
          "nodeName": "My Mac",
          // èŠ‚ç‚¹åˆ«åï¼ˆé›†ç¾¤å†…å”¯ä¸€ï¼Œç”¨äº #åˆ«å æåŠï¼‰
          "nodeAlias": "home",
          // èƒ½åŠ›æ ‡ç­¾
          "capabilities": ["coding", "shell"],
          // å¯åŠ¨æ—¶è‡ªåŠ¨è¿æ¥ Hub
          "autoConnect": true

          // === ä»¥ä¸‹å­—æ®µæ³¨å†Œåè‡ªåŠ¨å†™å…¥ï¼Œæ— éœ€æ‰‹åŠ¨å¡« ===
          // "nodeId": "",
          // "token": "",
          // "clusterId": "",
          // "parentId": null
        }
      }
    }
  }
}
```

> **æ³¨æ„**: ä»¥ä¸Šåªå±•ç¤ºäº† `cluster-hub` ç›¸å…³é…ç½®ï¼Œå®é™… `openclaw.json` ä¸­è¿˜æœ‰å…¶ä»–é…ç½®é¡¹ï¼ˆ`auth`ã€`agents`ã€`channels` ç­‰ï¼‰ï¼Œè¯·å‹¿è¦†ç›–å·²æœ‰å†…å®¹ã€‚

### åŠ å…¥å·²æœ‰é›†ç¾¤ï¼ˆå­èŠ‚ç‚¹ï¼‰

è·å–çˆ¶èŠ‚ç‚¹çš„ ID å’Œé‚€è¯·ç ï¼Œåœ¨é…ç½®ä¸­æ·»åŠ  `parentId`ï¼š

```jsonc
{
  "config": {
    "hubUrl": "https://hub.openclaw.ai",
    "nodeName": "Office Mac",
    "nodeAlias": "office",
    "parentId": "çˆ¶èŠ‚ç‚¹çš„UUID",
    "capabilities": ["coding", "shell"]
  }
}
```

## å¿«é€Ÿå¼€å§‹

### 1. åˆ›å»ºé›†ç¾¤ï¼ˆæ ¹èŠ‚ç‚¹ï¼‰

é…ç½®å¥½ `hubUrl`ã€`nodeName`ã€`nodeAlias` åæ³¨å†Œï¼š

```bash
openclaw hub register
```

æ³¨å†ŒæˆåŠŸå `nodeId`ã€`token`ã€`clusterId` è‡ªåŠ¨å†™å…¥é…ç½®ã€‚

### 2. åŠ å…¥é›†ç¾¤ï¼ˆå­èŠ‚ç‚¹ï¼‰

```bash
openclaw hub register --parent <çˆ¶èŠ‚ç‚¹ID> --invite <é‚€è¯·ç >
```

### 3. å¼€å§‹ä½¿ç”¨

```bash
# æŸ¥çœ‹é›†ç¾¤çŠ¶æ€
openclaw hub status

# æŸ¥çœ‹æ‰€æœ‰èŠ‚ç‚¹
openclaw hub nodes

# ç»™èŠ‚ç‚¹å‘æŒ‡ä»¤
openclaw hub send <èŠ‚ç‚¹åˆ«å> "æ£€æŸ¥ç£ç›˜ç©ºé—´"

# æŸ¥çœ‹ä»»åŠ¡
openclaw hub tasks
```

## AI å·¥å…·

å®‰è£…å AI è‡ªåŠ¨è·å¾—ä»¥ä¸‹å·¥å…·ï¼š

| å·¥å…· | è¯´æ˜ |
|------|------|
| `hub_status` | æŸ¥çœ‹ Hub è¿æ¥çŠ¶æ€å’ŒèŠ‚ç‚¹åˆ—è¡¨ |
| `hub_nodes` | åˆ—å‡ºé›†ç¾¤æ‰€æœ‰èŠ‚ç‚¹è¯¦æƒ… |
| `hub_send` | ç»™èŠ‚ç‚¹å‘é€ä»»åŠ¡ |
| `hub_batch_send` | æ‰¹é‡å‘å¤šä¸ªèŠ‚ç‚¹ä¸‹å‘ä»»åŠ¡ï¼ˆå¹¶è¡Œï¼‰ |
| `hub_wait_task` | ç­‰å¾…å•ä¸ªä»»åŠ¡å®Œæˆå¹¶è¿”å›ç»“æœ |
| `hub_wait_all` | ç­‰å¾…å¤šä¸ªä»»åŠ¡å…¨éƒ¨å®Œæˆå¹¶æ±‡æ€» |
| `hub_tasks` | æŸ¥çœ‹ä»»åŠ¡é˜Ÿåˆ—å’Œå†å² |

### é£ä¹¦å·¥å…·ï¼ˆHub è‡ªåŠ¨ä¸‹å‘ï¼‰

å¦‚æœ Hub é…ç½®äº†é£ä¹¦åº”ç”¨å‡­æ®ï¼ŒèŠ‚ç‚¹è¿æ¥åè‡ªåŠ¨è·å¾—ä»¥ä¸‹å·¥å…·ï¼š

| å·¥å…· | è¯´æ˜ |
|------|------|
| `feishu_doc` | æ–‡æ¡£æ“ä½œï¼ˆè¯»/å†™/è¿½åŠ /åˆ›å»º/å—ç¼–è¾‘ï¼‰ |
| `feishu_wiki` | çŸ¥è¯†åº“æ“ä½œï¼ˆç©ºé—´/èŠ‚ç‚¹/åˆ›å»ºï¼‰ |
| `feishu_drive` | äº‘ç©ºé—´ç®¡ç†ï¼ˆæ–‡ä»¶åˆ—è¡¨/åˆ›å»ºæ–‡ä»¶å¤¹/ç§»åŠ¨/åˆ é™¤ï¼‰ |
| `feishu_perm` | æƒé™ç®¡ç†ï¼ˆæŸ¥çœ‹/æ·»åŠ /ç§»é™¤åä½œè€…ï¼‰ |
| `feishu_contact` | é€šè®¯å½•æŸ¥è¯¢ï¼ˆæŒ‰å§“åæœç´¢/æŒ‰é‚®ç®±æŸ¥ open_idï¼‰ |
| `feishu_message` | å‘é€é£ä¹¦æ¶ˆæ¯ï¼ˆæ–‡æœ¬/å¯Œæ–‡æœ¬/æ‰¹é‡å‘é€ï¼‰ |
| `feishu_app_scopes` | æŸ¥çœ‹åº”ç”¨æƒé™ |

> **å†²çªå¤„ç†**: å¦‚æœèŠ‚ç‚¹å·²å®‰è£…å¹¶å¯ç”¨äº† OpenClaw é£ä¹¦æ’ä»¶ï¼ŒHub ä¸‹å‘çš„å·¥å…·ä¼šè‡ªåŠ¨è·³è¿‡ï¼Œä¸ä¼šå†²çªã€‚

**AI å¯¹è¯ç¤ºä¾‹ï¼š**

```
"æŸ¥çœ‹é›†ç¾¤çŠ¶æ€"
"è®© #office æ‰§è¡Œ ls -la"
"ç»™æ‰€æœ‰èŠ‚ç‚¹å‘é€ 'æŠ¥å‘Šç³»ç»Ÿè´Ÿè½½'"
```

## Gateway RPC

æ’ä»¶å‘ Gateway æ³¨å†Œäº† 18+ ä¸ª RPC æ–¹æ³•ï¼ˆ`hub.*`ï¼‰ï¼Œä¾›æ§åˆ¶å°å’Œå¤–éƒ¨å·¥å…·è°ƒç”¨ï¼š

| RPC | è¯´æ˜ |
|-----|------|
| `hub.status` | è¿æ¥çŠ¶æ€ + changeSeq |
| `hub.connect` / `hub.disconnect` | è¿æ¥/æ–­å¼€ Hub |
| `hub.register` / `hub.unregister` | æ³¨å†Œ/æ³¨é”€èŠ‚ç‚¹ |
| `hub.nodes` / `hub.node` | èŠ‚ç‚¹åˆ—è¡¨/è¯¦æƒ… |
| `hub.children` / `hub.tree` / `hub.clusters` | å­èŠ‚ç‚¹/æ ‘å½¢/é›†ç¾¤ |
| `hub.node.update` | æ›´æ–°èŠ‚ç‚¹åç§°/åˆ«å |
| `hub.invite.set` / `hub.invite.get` | è®¾ç½®/è·å–é‚€è¯·ç  |
| `hub.task.send` / `hub.task.list` / `hub.task.get` / `hub.task.cancel` / `hub.task.clear` | ä»»åŠ¡ç®¡ç† |
| `hub.chat.send` / `hub.chat.history` / `hub.chat.list` / `hub.chat.clear` | èŠå¤©ç®¡ç† |
| `hub.node.events` | èŠ‚ç‚¹ä¸Šä¸‹çº¿äº‹ä»¶ |

## é…ç½®é¡¹

| é…ç½®é¡¹ | ç±»å‹ | é»˜è®¤å€¼ | è¯´æ˜ |
|--------|------|--------|------|
| `hubUrl` | string | â€” | Hub æœåŠ¡åœ°å€ |
| `nodeName` | string | â€” | èŠ‚ç‚¹æ˜¾ç¤ºåç§° |
| `nodeAlias` | string | â€” | èŠ‚ç‚¹åˆ«åï¼ˆ`#` æåŠç”¨ï¼Œé›†ç¾¤å†…å”¯ä¸€ï¼‰ |
| `capabilities` | string[] | `["coding","shell"]` | èƒ½åŠ›æ ‡ç­¾ |
| `parentId` | string\|null | null | çˆ¶èŠ‚ç‚¹ IDï¼ˆnull = åˆ›å»ºæ–°é›†ç¾¤ï¼‰ |
| `autoConnect` | boolean | true | å¯åŠ¨æ—¶è‡ªåŠ¨è¿æ¥ |
| `selfTaskMode` | `"local"\|"hub"` | `"local"` | è‡ªå‘ä»»åŠ¡æ¨¡å¼ |
| `heartbeatIntervalMs` | number | 30000 | å¿ƒè·³é—´éš” (ms) |
| `reconnectIntervalMs` | number | 5000 | æ–­çº¿é‡è¿é—´éš” (ms) |
| `taskTimeoutMs` | number | 300000 | ä»»åŠ¡è¶…æ—¶ (ms) |
| `nodeId` | string | â€” | æ³¨å†Œåè‡ªåŠ¨å†™å…¥ |
| `token` | string | â€” | JWT Tokenï¼Œæ³¨å†Œåè‡ªåŠ¨å†™å…¥ |
| `clusterId` | string | â€” | é›†ç¾¤ IDï¼Œæ³¨å†Œåè‡ªåŠ¨å†™å…¥ |

## æ¶ˆæ¯ç±»å‹

Hub èŠ‚ç‚¹é—´é€šè¿‡ WebSocket é€šä¿¡ï¼Œæ”¯æŒä»¥ä¸‹æ¶ˆæ¯ç±»å‹ï¼š

| ç±»å‹ | æ–¹å‘ | è¯´æ˜ |
|------|------|------|
| `task` | çˆ¶â†’å­ | ä¸‹å‘ä»»åŠ¡ |
| `result` | å­â†’çˆ¶ | ä»»åŠ¡ç»“æœ |
| `task_ack` / `task_status` | å­â†’çˆ¶ | ä»»åŠ¡çŠ¶æ€ä¸ŠæŠ¥ |
| `task_cancel` | çˆ¶â†’å­ | å–æ¶ˆä»»åŠ¡ |
| `chat` | ä»»æ„ | èŠ‚ç‚¹é—´èŠå¤©ï¼ˆä¸é™çˆ¶å­ï¼‰ |
| `direct` | ä»»æ„ | ç‚¹å¯¹ç‚¹æ¶ˆæ¯ï¼ˆåŒé›†ç¾¤ï¼‰ |
| `broadcast` | çˆ¶â†’å…¨éƒ¨ | å¹¿æ’­ |
| `heartbeat` | åŒå‘ | å¿ƒè·³ä¿æ´» |

## æ–‡ä»¶ç»“æ„

```
cluster-hub/
â”œâ”€â”€ package.json
â”œâ”€â”€ openclaw.plugin.json    # æ’ä»¶æ¸…å• + é…ç½® Schema
â”œâ”€â”€ README.md
â”œâ”€â”€ docs/
â”‚   â””â”€â”€ CLI.md              # CLI å‘½ä»¤å®Œæ•´å‚è€ƒ
â””â”€â”€ src/
    â”œâ”€â”€ index.ts            # æ’ä»¶å…¥å£ï¼ˆRPC + AI å·¥å…· + CLI + åå°æœåŠ¡ï¼‰
    â”œâ”€â”€ hub-client.ts       # Hub é€šè®¯å®¢æˆ·ç«¯ï¼ˆWebSocket + RESTï¼‰
    â”œâ”€â”€ feishu-tools.ts     # é£ä¹¦å·¥å…·é›†ï¼ˆHub ä¸‹å‘å‡­æ®ï¼Œè‡ªåŠ¨æ³¨å†Œï¼‰
    â”œâ”€â”€ store.ts            # æŒä¹…åŒ–å­˜å‚¨ï¼ˆä»»åŠ¡/èŠå¤©/èŠ‚ç‚¹äº‹ä»¶ï¼‰
    â””â”€â”€ types.ts            # ç±»å‹å®šä¹‰
```

## æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  OpenClaw Node  â”‚     â”‚  OpenClaw Node  â”‚
â”‚  (cluster-hub)  â”‚     â”‚  (cluster-hub)  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚ WebSocket              â”‚ WebSocket
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”Œâ”€â”€â”€â”´â”€â”€â”´â”€â”€â”€â”
                 â”‚  Hub æœåŠ¡  â”‚
                 â”‚ (äº‘ç«¯ä¸­è½¬)  â”‚
                 â””â”€â”€â”€â”¬â”€â”€â”¬â”€â”€â”€â”˜
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚ WebSocket              â”‚ WebSocket
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  OpenClaw Node  â”‚     â”‚   é£ä¹¦æœºå™¨äºº     â”‚
â”‚  (cluster-hub)  â”‚     â”‚  (Hub å†…ç½®)     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## æ–‡æ¡£

- **[CLI å‘½ä»¤å‚è€ƒ](docs/CLI.md)** â€” æ‰€æœ‰ CLI å‘½ä»¤ã€AI å·¥å…·ã€Gateway RPC è¯¦ç»†è¯´æ˜

## License

MIT
